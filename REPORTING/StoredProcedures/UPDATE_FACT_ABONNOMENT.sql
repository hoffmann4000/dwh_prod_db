CREATE PROCEDURE [REPORTING].[UPDATE_FACT_ABONNOMENT]
--CHO 10.5.2021 BYGGES FOR AT KUNNE TÃ†LLE ABONNMENTER TILBAGE OG FREM I TID
--CHO 10.5.2021 DET EGENTLIGE DATAGRUNDLAG SKAL SES I BASELINE.DIM_ABONNOMENT_V
AS
BEGIN
IF OBJECT_ID('REPORTING.FACT_ABONNEMENT', 'U') IS NOT NULL 

TRUNCATE TABLE REPORTING.FACT_ABONNEMENT;

INSERT INTO REPORTING.FACT_ABONNEMENT
	(
	ABONNEMENT_ID,
	CUST,
	COUNTRY_ID,
	MOBIL_NR,
	NAVN,
	EXTRA,
	ABN,
	STARTDATE,
	ENDDATE,
	ICC,
	SUSPENDED,
	IMSI,
	NUMBERTYPE,
	ICCTYPE,
	OPERATOR_ID,
	STATUS_ID,
	STATUS_NAVN,
	DATE_ID
	)

SELECT 
	ABN_ID,
	CUST,
	COUNTRY_ID,
	MOBIL_NR,
	NAVN,
	EXTRA,
	ABN,
	STARTDATE,
	ENDDATE,
	ICC,
	SUSPENDED,
	IMSI,
	NUMBERTYPE,
	ICCTYPE,
	OPERATOR_ID,
	STATUS_ID,
	STATUS_NAVN,
	DATE_ID

FROM [BASELINE].[ABONNOMENTER_PR_MND_V];

END;

GO

